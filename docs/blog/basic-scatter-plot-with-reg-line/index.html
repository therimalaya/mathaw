<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Basic Scatter Plot and linear fitted line | Mathaw</title>
  <meta name="description" content="Mathatistics includes tips, tutorials, techniques and some articles 
related to Epidemilogy, Survival Analysis, Multivariate Analysis, Statistics, 
Data Science, Programming, LaTeX and Web Development.
">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Basic Scatter Plot and linear fitted line" />
<meta property="og:description" content="Lets scatter into some points created by data in xy-space. Data are scattered everywhere but what relation is there between some specific variable with other. Cutting down to simple talking and stick to the heading, we can use mtcars dataset in R.
The dataset from Motor Trend US magazine, 1974 comprises fuel consumption and 10 various aspects of automobile design and their performance for 32 automobiles of different models. I will try to obtain the scatter plot for the model and the fitted line for the model." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/basic-scatter-plot-with-reg-line/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2017-03-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2017-03-01T00:00:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Basic Scatter Plot and linear fitted line"/>
<meta name="twitter:description" content="Lets scatter into some points created by data in xy-space. Data are scattered everywhere but what relation is there between some specific variable with other. Cutting down to simple talking and stick to the heading, we can use mtcars dataset in R.
The dataset from Motor Trend US magazine, 1974 comprises fuel consumption and 10 various aspects of automobile design and their performance for 32 automobiles of different models. I will try to obtain the scatter plot for the model and the fitted line for the model."/>

  
  
    
  
  
  


<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css' rel='stylesheet' type='text/css' />



  <link rel="stylesheet" href=/lib/bootstrap/css/bootstrap.min.css>
  <link rel="stylesheet" href="/css/style-white.css">
  <link rel="stylesheet" href="/css/ui-extra.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="/images/favicon.ico" />

  
  
  
  
</head>


<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/blog">Writings</a></li>
         
        <li><a href="https://therimalaya.github.io/mathaw">Blog</a></li>
         
        <li><a href="/photography">Photography</a></li>
         
        <li><a href="/about">About me</a></li>
         
        <li><a href="/cv">Resume</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /blog/latex-html-tables-in-r/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="/blog/model-assessment-variable-selection/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fblog%2fbasic-scatter-plot-with-reg-line%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&text=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&is_video=false&description=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line&body=Check out this article: %2fblog%2fbasic-scatter-plot-with-reg-line%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&name=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line&description=Lets%20scatter%20into%20some%20points%20created%20by%20data%20in%20xy-space.%20Data%20are%20scattered%20everywhere%20but%20what%20relation%20is%20there%20between%20some%20specific%20variable%20with%20other.%20Cutting%20down%20to%20simple%20talking%20and%20stick%20to%20the%20heading%2c%20we%20can%20use%20mtcars%20dataset%20in%20R.%0aThe%20dataset%20from%20Motor%20Trend%20US%20magazine%2c%201974%20comprises%20fuel%20consumption%20and%2010%20various%20aspects%20of%20automobile%20design%20and%20their%20performance%20for%2032%20automobiles%20of%20different%20models.%20I%20will%20try%20to%20obtain%20the%20scatter%20plot%20for%20the%20model%20and%20the%20fitted%20line%20for%20the%20model.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&t=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>


    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
      <header>
        <h1 class="posttitle" itemprop="name headline">
          Basic Scatter Plot and linear fitted line
        </h1>
        <div class="meta">
          
          <div class="postdate">
            
            <time datetime="2017-03-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">Mar 1, 2017</time>
            
          </div>
          
          
          <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/%20/tags/r" rel="tag">R</a>
            
             ,  
            <a class="tag-link" href="/%20/tags/statistics" rel="tag">Statistics</a>
            
             ,  
            <a class="tag-link" href="/%20/tags/regression" rel="tag">Regression</a>
            
             ,  
            <a class="tag-link" href="/%20/tags/visualization" rel="tag">Visualization</a>
            
          </div>
          
        </div>
      </header>

      <div class="content" itemprop="articleBody">
        


<p>Lets scatter into some points created by data in xy-space. Data are scattered everywhere but what relation is there between some specific variable with other. Cutting down to simple talking and stick to the heading, we can use <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html"><code>mtcars</code></a> dataset in R.</p>
<p>The dataset from Motor Trend US magazine, 1974 comprises fuel consumption and 10 various aspects of automobile design and their performance for 32 automobiles of different models. I will try to obtain the scatter plot for the model and the fitted line for the model.</p>
<p>In R, there are three popular packages for obtaining plots <em>Base Graphics</em>, <em>Lattice Plot</em> and <em>ggplot2</em>. Here we will create a scatter plot between two variables <code>mpg</code> (mile per gallon) and <code>disp</code>(displacement) along with the fitted regession line with equation and <span class="math inline">\(R²\)</span> value in it using all there graphics packages.</p>
<p>Lets first fit a linear model,</p>
<pre class="r"><code>mdl &lt;- lm(mpg ~ disp, data = mtcars)
sumry &lt;- summary(mdl)
cf &lt;- round(coef(mdl), 2)

eqn &lt;- paste(terms(mdl)[[2]],
             paste0(cf[1], ifelse(cf[2] &lt; 0, &quot; &quot;, &quot; + &quot;),
                    cf[2], &quot; &quot;, terms(mdl)[[3]]), sep = &quot; = &quot;)
sumry.lbl &lt;- paste0(&quot;R^2: &quot;, round(sumry$r.squared, 2),
                    &quot;, adj R^2: &quot;, round(sumry$adj.r.squared, 2))</code></pre>
<div id="plots" class="section level2 tabset">
<h2>Plots</h2>
<div id="base-graphics" class="section level3 tab">
<h3>Base Graphics</h3>
<pre class="r"><code>with(mtcars, {
  plot(disp, mpg, pch = 22, bg = &quot;gray&quot;,
       xlab = &quot;Displacement&quot;, ylab = &quot;Mile per Gallon&quot;,
       main = &quot;Displacement vs Mile per Gallon&quot;)
  abline(mdl, col = &quot;red&quot;, lty = 2, lwd = 2)
  text(max(disp), max(mpg), adj = c(1, 1), family = &quot;monospace&quot;,
       label = paste(eqn, sumry.lbl, sep = &quot;\n&quot;))
})</code></pre>
<p><img src="/blog/basic-scatter-plot-with-reg-line/index_files/figure-html/unnamed-chunk-3-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="lattice-plot" class="section level3 tab">
<h3>Lattice Plot</h3>
<pre class="r"><code>library(lattice)
lm.panel &lt;- function(x, y, ...) {
  panel.xyplot(x, y, pch = 22, fill = &quot;gray&quot;,
               cex = 1.2, col = &quot;black&quot;)
  panel.text(max(x), max(y), pos = 2,
             fontfamily = &quot;monospace&quot;,
             label = paste(eqn, sumry.lbl, sep = &quot;\n&quot;))
  panel.abline(mdl, col = &quot;red&quot;, lty = 2, lwd = 2)
}
xyplot(mpg ~ disp, data = mtcars,
       panel = lm.panel,
       main = &quot;Displacement vs Mile per Gallon&quot;,
       xlab = &quot;Displacement&quot;, ylab = &quot;Mile per Gallon&quot;)</code></pre>
<p><img src="/blog/basic-scatter-plot-with-reg-line/index_files/figure-html/unnamed-chunk-4-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="ggplot" class="section level3 tab">
<h3>ggplot</h3>
<pre class="r"><code>library(ggplot2)
plt &lt;- qplot(disp, mpg, data = mtcars, geom = c(&quot;point&quot;),
             xlab = &quot;Displacement&quot;,
             ylab = &quot;Mile per Gallon&quot;,
             main = &quot;Displacement vs Mile per Gallon&quot;,
             size = I(3), shape = I(22), fill = I(&quot;grey&quot;))
plt + theme_bw() +
  geom_smooth(method = &quot;lm&quot;, color = &quot;red&quot;, linetype = 2) +
  annotate(x = Inf, y = Inf, geom = &quot;text&quot;,
           hjust = 1.2, vjust = 1.2,
           family = &quot;monospace&quot;,
           label = paste(eqn, sumry.lbl, sep = &quot;\n&quot;))</code></pre>
<p><img src="/blog/basic-scatter-plot-with-reg-line/index_files/figure-html/unnamed-chunk-5-1.svg" width="100%" style="display: block; margin: auto;" /></p>
<p>The fitted regression summary is,</p>
<pre><code>
Call:
lm(formula = mpg ~ disp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8922 -2.2022 -0.9631  1.6272  7.2305 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
disp        -0.041215   0.004712  -8.747 9.38e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 3.251 on 30 degrees of freedom
Multiple R-squared:  0.7183,    Adjusted R-squared:  0.709 
F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10</code></pre>
<p>This means, the effect of displacement on mile per gallon of the cars in the model is negative and its magnitude is 0.04. In other words, on one unit change of displacement, the car will travel 0.04 less per gallon.</p>
</div>
</div>

      </div>
    </article>

    
  





    <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/blog">Writings</a></li>
         
          <li><a href="https://therimalaya.github.io/mathaw">Blog</a></li>
         
          <li><a href="/photography">Photography</a></li>
         
          <li><a href="/about">About me</a></li>
         
          <li><a href="/cv">Resume</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fblog%2fbasic-scatter-plot-with-reg-line%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&text=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&is_video=false&description=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line&body=Check out this article: %2fblog%2fbasic-scatter-plot-with-reg-line%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&title=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&name=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line&description=Lets%20scatter%20into%20some%20points%20created%20by%20data%20in%20xy-space.%20Data%20are%20scattered%20everywhere%20but%20what%20relation%20is%20there%20between%20some%20specific%20variable%20with%20other.%20Cutting%20down%20to%20simple%20talking%20and%20stick%20to%20the%20heading%2c%20we%20can%20use%20mtcars%20dataset%20in%20R.%0aThe%20dataset%20from%20Motor%20Trend%20US%20magazine%2c%201974%20comprises%20fuel%20consumption%20and%2010%20various%20aspects%20of%20automobile%20design%20and%20their%20performance%20for%2032%20automobiles%20of%20different%20models.%20I%20will%20try%20to%20obtain%20the%20scatter%20plot%20for%20the%20model%20and%20the%20fitted%20line%20for%20the%20model.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fblog%2fbasic-scatter-plot-with-reg-line%2f&t=Basic%20Scatter%20Plot%20and%20linear%20fitted%20line">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2023  Mathatistics 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/blog">Writings</a></li>
         
        <li><a href="https://therimalaya.github.io/mathaw">Blog</a></li>
         
        <li><a href="/photography">Photography</a></li>
         
        <li><a href="/about">About me</a></li>
         
        <li><a href="/cv">Resume</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


    

  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/lib/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/js/tabset.js></script>
<script src=/js/accordion.js></script>
<script src=/js/main.js></script>




<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"
  integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js"
  integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js"
  integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>


</html>