<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Scatter plot with multiple group | Mathatistics</title>
  <meta name="description" content="Mathatistics includes tips, tutorials, techniques and some articles 
related to Epidemilogy, Survival Analysis, Multivariate Analysis, Statistics, 
Data Science, Programming, LaTeX and Web Development.
">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Scatter plot with multiple group" />
<meta property="og:description" content="In many situations, it becomes essential to have a plot with multiple categories. For example, colour the scatter plot according to gender and have two different regression line for each of them.
Lets scatter the some points using data from mtcars, available default in R. Continuing the discussing from this post, where we had plotted mile per gallon (mpg) vs displacement (disp). Here we will create a separate regression line and colour the points accordingly based on number of cylinder (cyl) in the cars." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/scatter-plot-multple-group/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2016-01-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-01-12T00:00:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Scatter plot with multiple group"/>
<meta name="twitter:description" content="In many situations, it becomes essential to have a plot with multiple categories. For example, colour the scatter plot according to gender and have two different regression line for each of them.
Lets scatter the some points using data from mtcars, available default in R. Continuing the discussing from this post, where we had plotted mile per gallon (mpg) vs displacement (disp). Here we will create a separate regression line and colour the points accordingly based on number of cylinder (cyl) in the cars."/>

  
  
    
  
  
  


<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css' rel='stylesheet' type='text/css' />



  <link rel="stylesheet" href=/lib/bootstrap/css/bootstrap.min.css>
  <link id="light-mode-theme" rel="stylesheet" href="/css/style-white.css">
  <link disabled id="dark-mode-theme" rel="stylesheet" href=/css/style-dark.css>
  <link rel="stylesheet" href=/css/ui-extra.css>
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="/images/favicon.ico" />

  
  
  
  
</head>


<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/blog">Writings</a></li>
         
        <li><a href="http://mathaw.cloudrimalaya.com">Blog</a></li>
         
        <li><a href="/photography">Photography</a></li>
         
        <li><a href="/about">About me</a></li>
         
        <li><a href="/cv">Resume</a></li>
        
        <li><a href="#" id="theme-toggle"><i class="fa fa-moon"></i></a></li>
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /cv/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="/blog/latex-autocomplete-rstudio/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fblog%2fscatter-plot-multple-group%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fblog%2fscatter-plot-multple-group%2f&text=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fblog%2fscatter-plot-multple-group%2f&is_video=false&description=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Scatter%20plot%20with%20multiple%20group&body=Check out this article: %2fblog%2fscatter-plot-multple-group%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fblog%2fscatter-plot-multple-group%2f&name=Scatter%20plot%20with%20multiple%20group&description=In%20many%20situations%2c%20it%20becomes%20essential%20to%20have%20a%20plot%20with%20multiple%20categories.%20For%20example%2c%20colour%20the%20scatter%20plot%20according%20to%20gender%20and%20have%20two%20different%20regression%20line%20for%20each%20of%20them.%0aLets%20scatter%20the%20some%20points%20using%20data%20from%20mtcars%2c%20available%20default%20in%20R.%20Continuing%20the%20discussing%20from%20this%20post%2c%20where%20we%20had%20plotted%20mile%20per%20gallon%20%28mpg%29%20vs%20displacement%20%28disp%29.%20Here%20we%20will%20create%20a%20separate%20regression%20line%20and%20colour%20the%20points%20accordingly%20based%20on%20number%20of%20cylinder%20%28cyl%29%20in%20the%20cars.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fblog%2fscatter-plot-multple-group%2f&t=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>


    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
      <header>
        <h1 class="posttitle" itemprop="name headline">
          Scatter plot with multiple group
        </h1>
        <div class="meta">
          
          <div class="postdate">
            
            <time datetime="2016-01-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">Jan 12, 2016</time>
            
          </div>
          
          
          <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/%20/tags/statistics" rel="tag">Statistics</a>
            
             ,  
            <a class="tag-link" href="/%20/tags/regression" rel="tag">Regression</a>
            
             ,  
            <a class="tag-link" href="/%20/tags/r" rel="tag">R</a>
            
             ,  
            <a class="tag-link" href="/%20/tags/visualization" rel="tag">Visualization</a>
            
          </div>
          
        </div>
      </header>

      <div class="content" itemprop="articleBody">
        


<p>In many situations, it becomes essential to have a plot with multiple categories. For example, colour the scatter plot according to gender and have two different regression line for each of them.</p>
<p>Lets scatter the some points using data from <code>mtcars</code>, available default in R. Continuing the discussing from this post, where we had plotted mile per gallon (<code>mpg</code>) vs displacement (<code>disp</code>). Here we will create a separate regression line and colour the points accordingly based on number of cylinder (<code>cyl</code>) in the cars. In this article also, I will use there plotting system â€“ base graphics, lattice plot and ggplot2.</p>
<p>First, lets fit our linear model with number of cylinder as a categorical variable.</p>
<pre class="r"><code>mtcars &lt;- within(mtcars, cyl &lt;- as.factor(cyl))
mdl    &lt;- lm(mpg ~ disp * cyl, data = mtcars)
sumry  &lt;- summary(mdl)
sumry</code></pre>
<pre><code>
Call:
lm(formula = mpg ~ disp * cyl, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4766 -1.8101 -0.2297  1.3523  5.0208 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  40.87196    3.02012  13.533 2.79e-13 ***
disp         -0.13514    0.02791  -4.842 5.10e-05 ***
cyl6        -21.78997    5.30660  -4.106 0.000354 ***
cyl8        -18.83916    4.61166  -4.085 0.000374 ***
disp:cyl6     0.13875    0.03635   3.817 0.000753 ***
disp:cyl8     0.11551    0.02955   3.909 0.000592 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.372 on 26 degrees of freedom
Multiple R-squared:  0.8701,    Adjusted R-squared:  0.8452 
F-statistic: 34.84 on 5 and 26 DF,  p-value: 9.968e-11</code></pre>
<p>Lets create a (intercept, slope) pair for each level of <code>cyl</code> and create separate equation for them.</p>
<pre class="r"><code>cf  &lt;- round(coef(mdl), 3)
eq1 &lt;- c(cf[1], cf[2])
eq2 &lt;- c(cf[1] + cf[3], cf[2] + cf[5])
eq3 &lt;- c(cf[1] + cf[4], cf[2] + cf[6])
eq.fn &lt;- function(eq) {
  paste0(&quot;mpg = &quot;, eq[1],
         ifelse(eq[2] &lt; 0, &quot; - &quot;, &quot; + &quot;),
         abs(eq[2]), &quot; disp&quot;)
}
eqn &lt;- sapply(list(eq1, eq2, eq3), eq.fn)
rsq.info &lt;- c(paste0(&quot;R^2: &quot;, round(sumry[[&quot;r.squared&quot;]], 2)),
              paste0(&quot;adj. R^2: &quot;, round(sumry[[&quot;adj.r.squared&quot;]], 2)))</code></pre>
<div id="plots" class="section level2 tabset">
<h2>Plots</h2>
<div id="base-graphics" class="section level3 tab">
<h3>Base Graphics</h3>
<pre class="r"><code>with(mtcars, {
  car::scatterplot(disp, mpg, groups = cyl, smooth = F,
                   xlab = &quot;Displacement&quot;,
                   ylab = &quot;Mile per Gallon&quot;,
                   main = &quot;Mile per gallon vs displacement&quot;)
})
op &lt;- par(family = &quot;monospace&quot;)
legend(&quot;topright&quot;, text.col = 1:3, col = 1:3, box.lty = 0,
       lty = 1, lwd = 1, legend = eqn)
legend(&quot;bottomleft&quot;, legend = rsq.info)</code></pre>
<p><img src="/blog/scatter-plot-multple-group/index_files/figure-html/base-plot-1.svg" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>par(op)</code></pre>
</div>
<div id="lattice-plot" class="section level3 tab">
<h3>Lattice Plot</h3>
<pre class="r"><code>library(lattice)
lm.panel &lt;- function(x, y, ...) {
  panel.xyplot(x, y, ...)
  panel.abline(eq1, col = 1, lwd = 2, lty = 2)
  panel.abline(eq2, col = 2, lwd = 2, lty = 2)
  panel.abline(eq3, col = 3, lwd = 2, lty = 2)
  panel.text(max(x), max(y), pos = 2,
             fontfamily = &quot;monospace&quot;,
             label = paste(eqn, collapse = &quot;\n&quot;))
  panel.text(min(x), min(y), pos = 4,
             fontfamily = &quot;monospace&quot;,
             label = paste(rsq.info, collapse = &quot;\n&quot;))
}
xyplot(mpg ~ disp, data = mtcars, groups = cyl,
       auto.key = list(columns = 3, cex = 0.8,
                       title = &quot;Cylinder&quot;),
       col = 1:3, xlab = &quot;Displacement&quot;,
       ylab = &quot;Mile per gallon&quot;,
       panel = lm.panel)</code></pre>
<p><img src="/blog/scatter-plot-multple-group/index_files/figure-html/lattice-graphics-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="ggplot2" class="section level3 tab">
<h3>ggplot2</h3>
<pre class="r"><code>library(ggplot2)
## Equation table for displaying them on the plot
eqn.df &lt;- with(mtcars, {
  data.frame(
    cyl  = sort(unique(cyl)),
    mpg  = max(mpg) - c(1:3),
    disp = max(disp), eqn = eqn
  )
})
ggplot(mtcars, aes(disp, mpg, color = cyl)) +
  geom_point() +
  theme_bw(base_size = 14) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  geom_text(data = eqn.df, aes(label = eqn),
            hjust = 1, family = &quot;mono&quot;) +
  annotate(geom = &quot;text&quot;,
           x = min(mtcars$disp), y = min(mtcars$mpg),
           family = &quot;mono&quot;, hjust = 0,
           label = paste0(rsq.info, collapse = &quot;\n&quot;))</code></pre>
<p><img src="/blog/scatter-plot-multple-group/index_files/figure-html/ggplot-1.svg" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>

      </div>
    </article>

    
  






    <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/blog">Writings</a></li>
         
          <li><a href="http://mathaw.cloudrimalaya.com">Blog</a></li>
         
          <li><a href="/photography">Photography</a></li>
         
          <li><a href="/about">About me</a></li>
         
          <li><a href="/cv">Resume</a></li>
        
        <li><a href="#" id="theme-toggle"><i class="fa fa-moon"></i></a></li>
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fblog%2fscatter-plot-multple-group%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fblog%2fscatter-plot-multple-group%2f&text=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fblog%2fscatter-plot-multple-group%2f&is_video=false&description=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Scatter%20plot%20with%20multiple%20group&body=Check out this article: %2fblog%2fscatter-plot-multple-group%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fblog%2fscatter-plot-multple-group%2f&title=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fblog%2fscatter-plot-multple-group%2f&name=Scatter%20plot%20with%20multiple%20group&description=In%20many%20situations%2c%20it%20becomes%20essential%20to%20have%20a%20plot%20with%20multiple%20categories.%20For%20example%2c%20colour%20the%20scatter%20plot%20according%20to%20gender%20and%20have%20two%20different%20regression%20line%20for%20each%20of%20them.%0aLets%20scatter%20the%20some%20points%20using%20data%20from%20mtcars%2c%20available%20default%20in%20R.%20Continuing%20the%20discussing%20from%20this%20post%2c%20where%20we%20had%20plotted%20mile%20per%20gallon%20%28mpg%29%20vs%20displacement%20%28disp%29.%20Here%20we%20will%20create%20a%20separate%20regression%20line%20and%20colour%20the%20points%20accordingly%20based%20on%20number%20of%20cylinder%20%28cyl%29%20in%20the%20cars.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fblog%2fscatter-plot-multple-group%2f&t=Scatter%20plot%20with%20multiple%20group">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2023  Mathatistics 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/blog">Writings</a></li>
         
        <li><a href="http://mathaw.cloudrimalaya.com">Blog</a></li>
         
        <li><a href="/photography">Photography</a></li>
         
        <li><a href="/about">About me</a></li>
         
        <li><a href="/cv">Resume</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


    

  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/lib/bootstrap/js/bootstrap.bundle.min.js></script>
<script src=/js/tabset.js></script>
<script src=/js/accordion.js></script>
<script src=/js/main.js></script>




<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"
  integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js"
  integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js"
  integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>


</html>